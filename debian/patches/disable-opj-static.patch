Description: Do not define OPJ_STATIC
 Setting OPJ_STATIC when using openjpeg 2.1.1 causes the symbols to have
 visibility hidden and the final linker step to fail.
Author: Sebastian Ramacher <sramacher@debian.org>
Last-Update: 2016-07-12

--- ffmpeg-3.1.1.orig/configure
+++ ffmpeg-3.1.1/configure
@@ -5669,7 +5669,7 @@ enabled libopencv         && { check_hea
                                  require opencv opencv2/core/core_c.h cvCreateImageHeader -lopencv_core -lopencv_imgproc; } ||
                                require_pkg_config opencv opencv/cxcore.h cvCreateImageHeader; }
 enabled libopenh264       && require_pkg_config openh264 wels/codec_api.h WelsGetCodecVersion
-enabled libopenjpeg       && { check_lib openjpeg-2.1/openjpeg.h opj_version -lopenjp2 -DOPJ_STATIC ||
+enabled libopenjpeg       && { check_lib openjpeg-2.1/openjpeg.h opj_version -lopenjp2 ||
                                check_lib openjpeg-2.0/openjpeg.h opj_version -lopenjp2 -DOPJ_STATIC ||
                                check_lib openjpeg-1.5/openjpeg.h opj_version -lopenjpeg -DOPJ_STATIC ||
                                check_lib openjpeg.h opj_version -lopenjpeg -DOPJ_STATIC ||
--- ffmpeg-3.1.1.orig/libavcodec/libopenjpegdec.c
+++ ffmpeg-3.1.1/libavcodec/libopenjpegdec.c
@@ -37,6 +37,7 @@
 #include "thread.h"
 
 #if HAVE_OPENJPEG_2_1_OPENJPEG_H
+#  undef OPJ_STATIC
 #  include <openjpeg-2.1/openjpeg.h>
 #elif HAVE_OPENJPEG_2_0_OPENJPEG_H
 #  include <openjpeg-2.0/openjpeg.h>
--- ffmpeg-3.1.1.orig/libavcodec/libopenjpegenc.c
+++ ffmpeg-3.1.1/libavcodec/libopenjpegenc.c
@@ -35,6 +35,7 @@
 #include "internal.h"
 
 #if HAVE_OPENJPEG_2_1_OPENJPEG_H
+#  undef OPJ_STATIC
 #  include <openjpeg-2.1/openjpeg.h>
 #elif HAVE_OPENJPEG_2_0_OPENJPEG_H
 #  include <openjpeg-2.0/openjpeg.h>
